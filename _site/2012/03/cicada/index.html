
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>3301</title>
    
    <meta name="author" content="Max Bernstein">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/fasouto/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/fasouto/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="/assets/themes/fasouto/css/style.css" rel="stylesheet" type="text/css" media="all">
    <link href='http://fonts.googleapis.com/css?family=OFL+Sorts+Mill+Goudy+TT:regular,italic' rel='stylesheet' type='text/css' />

  </head>

  <body>


    <div class="container">
      
        <header class="row main-header">
          <div class="span3 logo"><h3><a href="/">max bernstein</a></h3></div>  
          <div class="span4 offset5">
    <nav>
        <ul class="nav nav-pills nav-menu blog-navigation">
            <li class=""><a href="/projects">projects</a></li>
            <li class=""><a href="/archive.html">blog</a></li>
            <li class=""><a href="//photos.bernsteinbear.com">photos</a></li>
        </ul>
    </nav>
</div>
        </header>

      <div class="content">
        
<div class="page-header">
  <h1>3301 <small></small></h1>
  <div class="date"><span>16 March 2012</span></div>
</div>

<div class="row">
  <div class="span8">
    <p><em>All names in this article have been changed to reflect usernames. Also, I mix points of view (“I”, “we”) since some parts were collective thinking, and others were individual. Some pieces of this story have been removed to protect the puzzle creators. I note where they are.</em></p>

<p>It all started when I was sitting in the middle of Advisory at school: my friend <em>all2well</em> told me about this puzzle that he’d found on the internet. 4chan’s /b/, specifically. A group had posted the following image:</p>

<p><img alt='First image we found.' src='http://i.imgur.com/1CcV1.jpg' /></p>

<p>It was January first, and from then I was hooked. all2well and I took “in this image” very literally, <code>wget</code>‘d the image, <code>cat</code>‘d it, and lo and behold — there was ASCII text at the very bottom. It read:</p>

<p><code>TIBERIVS CLAVDIVS CAESAR says &quot;lxxt&gt;33m2mqkyv2gsq3q=w]O2ntk&quot;</code></p>

<p>How odd. I’d never heard of Tiberius Claudius, but upon looking him up, I learned that he was the fourth Caesar. We used a used <code>rot4</code> on the string in quotes. Out of that came a URL: <a href='http://i.imgur.com/m9sYK.jpg'>http://i.imgur.com/m9sYK.jpg</a></p>

<p><img alt='After decoding the ciphered text, we found this.' src='http://i.imgur.com/m9sYK.jpg' /></p>

<p>At this point, I joined an IRC channel on <a href='http://mibbit.com'>mibbit</a>. From there, I narrowed the groupd down from 30 people to around 10, and we collectively worked on this. This is where <code>cancer0</code>, <code>habitres</code>, <code>wakeen</code>, <code>manbearpig</code>, <code>r</code>, <code>math</code>, and <code>snogfarth</code> came into play.</p>

<p>The words “out” and “guess” got us thinking. I was pretty sure that I’d heard of a steganography tool called “outguess”. For those of you unfamiliar with steganography, it’s the practice of inserting and extracting hidden data into and from carrier files (Wikipedia).</p>

<p>After getting the outguess source from their website (http://www.outguess.org/download.php), I built and compiled it. Man pages were invaluable.</p>

<p><code>outguess -r final.jpg final.txt</code></p>

<p>That command extracted hidden text from <code>final.jpg</code> and wrote it into <code>final.txt</code>. Surprise, surprise - there was hidden text:</p>

<p>“Here is a book code. To find the book, and more information, go to http://www.reddit.com/r/a2e7j6ic78h0j/” (missing the 76 lines of book code following — to see the whole thing, visit <a href='http://pastebin.com/aXYZzzcv'>this pastebin</a>)</p>

<p>Naturally, we followed the link. To our surprise, there were already subreddit subscribers… How odd. Some had even replied to posts in the subreddit. Looking back on that, I realized others were toying with us.</p>

<p>The creator and moderator of the subreddit was <code>CageThrottleUs</code>.</p>

<p>In the header of the subreddit, there were some Mayan numerals:</p>

<p><img alt='Curious. Very curious indeed.' src='http://i.imgur.com/esmLM.png' /></p>

<p>In the sidebar of the subreddit, there was a line that said “Verify: 7A35090F”. This same string also appeared in the title text of the Mayan numerals image.</p>

<p>All of the posts in the subreddit were complete gibberish — not a single was English, or any other discernible language. Evidently, some cipher had been used to mangle the text.</p>

<p>Among the <a href='http://i.imgur.com/awBeR.png'>nonsensical posts</a> was one clear one, entitled “Welcome.” It linked to an image of a doormat:</p>

<p><img alt='Welcome to a world of puzzles.' src='http://i.imgur.com/KXLOP.jpg' /></p>

<p>From then, it was sort of a dead end, until one of us realized that we might as well try <code>outguess</code> on the doormat image. Bingo. <a href='http://pastebin.com/Xs15TLBj'>This text</a> came of it.</p>

<p>Since they announced that they would now always PGP sign messages, we’d know for sure if they posted something.</p>

<p>What is PGP? PGP is an <a href='http://en.wikipedia.org/wiki/Acronym_and_initialism'>initialism</a> that stands for “Pretty Good Privacy.” It’s a form of encryption and identity verification, through what’s called “public key cryptography.” It ensures that no one can read a message except for its intended recipient. Signing is a way to ensure that anyone can read a message, and that it came from a certain recipient.</p>

<p>I promptly ran <code>gpg --keyserver pgp.mit.edu --recv-key 7A35090F</code> to download and import their public key. When I examined the key further, I noted that the UID (user ID) field was set to “Cicada 3301 (845145127)”. This number, 845145127, was previously unseen. Same deal with Cicada.</p>

<p>From there, we began a full search on Google Books for reference on Mayan numbers, “Cicada 3301”, and 845145127.</p>

<p>After hours of very well-timed posts every six hours, a post appeared on the subreddit, titled “Problem?”. It had <a href='http://pastebin.com/AmP7yJ5S'>signed outguess text</a> that gave a very vague hint about the location of the key, and a reference to the Holy Grail. One thing was strange about this post: it was posted by a different user, “ImagoOnNib”.</p>

<p>We tried and failed to find anagrams of ImagoOnNib and CageThrottleUs using <a href='http://wordsmith.org/anagram/'>this website</a>, which proved very unproductive.</p>

<p>At some point later on, however, we realized that ImagoOnNib is an anagram for Mabinogion, the title of King Arthur’s story, and CageThrottleUs is an anagram for Charlotte Guest, the first person to translate the Mabinogion to English.</p>

<p>From the Mayan numerals in the header, the subreddit name (a2e7j6ic78h0j7eiejd0120), and the sidebar text, we derived the number sequence:</p>

<p><code>10, 2, 14, 7, 19, 6, 18, 12, 7, 8, 17, 0, 19, 7, 14, 18, 14, 19, 13, 0, 1, 2, 0</code></p>

<p>For example, each character and figure in the sidebar text can be interpreted as a sort of expanded hexadecimal to yield this sequence. We took the gibberish text from the subreddit, in the order posted, and performed a sort of hybrid Caesarr shift. That produced a segment of an Arthurian legend.</p>

<h4 id='example'>Example:</h4>

<p>The first word of the garbage text is “Ukbn” — taking the first four numbers in the sequence and applying them in a manner similar to a shift cipher, we get this:</p>

<pre><code>U - 10 = K
k - 2 = i
b - 14 = n
n - 7 = g</code></pre>

<p>As you can see, we get “King” — the next word is “Arthur”, and so on. When we ran out of numbers or started a new line, we started from the beginning of the shift key.</p>

<p>Then, we used the book codes (in the format <code>line:char</code>) to get a series of characters from the mass of text.</p>

<p>This was all computed using Python, on <a href='http://ideone.com'>ideone.com</a> (so we could easily share code and results).</p>

<p>At first, the text was a tad mangled, so we realized that there must be a formatting error. One of the errors was that Reddit removes excess spaces from posts, so that offeset characters. We managed to extract a telephone number, spelled out, from: <code>Call us at us tele phone numBer two one four three nine oh nine six oh eight</code></p>

<p>Naturally, we called it.</p>

<p>A computer-generated voice answered, and said, “Very good. You have done well. There are three prime numbers associated with the original final.jpg image. 3301 is one of them. You will have the find the other two. Multiply all three of these numbers together and add a .com to find the next step. Good luck.”</p>

<p>Here is a <a href='http://www.youtube.com/watch?v=k24ZrFR2IUQ'>YouTube clip</a>, posted by our very own <code>habitres</code>.</p>

<p>Turns out that the other two prime numbers referenced are the width and height of the first image. We multiplied them all together and added a .com to get 845145127.com (now down). On the website, there was a picture of a cicada with a countdown to 9AM PST/12:00 Noon EST/17:00 UTC on Monday.</p>

<p>Naturally, we ran <code>outguess</code> on the cicada image, and found <a href='http://pastebin.com/L0i40NA0'>this text</a>.</p>

<p>At 17:00 UTC on Monday (expected), the site changed to a list of coordinates and this message: “Find our symbol at the location nearest you.”</p>

<p>The cicada.jpg also changed to contain a <a href='http://pastebin.com/iVctZ9TJ'>signed outguess text</a> with the same list of coordinates.</p>

<p>We rallied people in the IRC channels, and found which were nearest to which coordinates.</p>

<p>One of the coordinates was located in Seattle, at Dr. Charles A. Rohrmann, Jr.’s house. We found his home and cell phone number on his medical profile, and called him.</p>

<p>It went something like this:</p>

<pre><code>R: Hello. I am calling because a list of GPS coordinates were posted online. One of them led to your house. Have you noticed anything strange outside your house? Maybe suspicious people? New buildings? People knocking?
Doctor: Where are you calling from?
R: London.
Doctor: How do you know about my house?
R: Like I said, there was a list of GPS coordinates posted online.
Doctor: Ive not had anything strange beside this call, no.
R: Nothing at all?
Doctor: No.
R: Well, people may come up in the future. They may ask about the number 3301 or cicadas. Have you seen anything regarding either of them.
Doctor: No I have not.
*Hangs up*</code></pre>

<p><code>habitres</code>’s brother Bongo went do Sydney, Australia and found two pictures of a QR code. The codes scanned to images on 845145127.com.</p>

<p><code>manbearpig</code> called the barber shop located at coordinate 4, posing as a student doing a geocaching project. He asked them to take a small look outside, but they saw nothing.</p>

<p>We <code>outguess</code>ed some of the images that the codes linked to, and found <a href='http://pastebin.com/dKq51NsS'>this text</a>. Another book code.</p>

<p>Another several images had <a href='http://pastebin.com/dbAk6an2'>different text</a>.</p>

<p>The second pastebin referred to the poem Agrippa, by William Gibson. Wikipedia explains that, “Its principal notoriety arose from the fact that the poem, stored on a 3.5” floppy disk, was programmed to erase itself after a single use; similarly, the pages of the artist’s book were treated with photosensitive chemicals, effecting the gradual fading of the words and images from the book’s first exposure to light.”</p>

<p>The full text is available <a href='http://www.williamgibsonbooks.com/source/agrippa.asp'>here</a> and the code to decode it <a href='http://ideone.com/7uk2z'>here</a>.</p>

<p>The book codes did not encode two characters, both of which were <code>6</code> - the first two primes (2,3) multiplied.</p>

<p>Decoding the text results in getting a .onion domain, <code>sq6wmgv2zcsrix6t.onion</code>. We all installed Tor and promptly logged on.</p>

<p>We were greeted with this screen:</p>

<p><img alt='this screen' src='http://i.imgur.com/6mBiv.jpg' /></p>

<p>(kudos to <code>Traveler</code>, another IRC user), with <a href='http://pastebin.com/TQ5e5snx'>this</a> HTML.</p>

<p>Everybody in the channel immediately registered tens of email addresses on <a href='http://mailinator.com'>mailinator</a>. The site went down around Tuesday, January 10, 23:45 UTC, after many users had put in their email addresses.</p>

<p>The next day, <code>newcandy</code> discovered that 845145127.com had changed, and was now devoid of image and text. A quick look at the source revealed <code>&lt;pre&gt;</code> tags, with a lot of space between them. What was in between? <a href='http://pastebin.com/TbJBG1NB'>Many tabs and spaces</a>. We figured that this had to be binary, and decrypted it to find <a href='http://pastebin.com/wgwpenx7'>this text</a>.</p>

<p>This was the first message not to be signed by <code>3301</code>.</p>

<p><code>newcandy</code> realized that some of the numbers looked like the filenames we’d tried, and so he went to work checking them out. I <code>wget</code>ed all of them.</p>

<p>About 2-4 afters after I grabbed them, the DNS entry for 845145127.com was changed to 127.0.0.1, and the previous IP (75.119.203.244) stopped responding to pings and TCP SYNs.</p>

<p>At this point, our story takes a darker turn. Our elite IRC group of 8 people deceived the rest, and led them on a wild goose chase. We created a branch off the puzzle, and led them solving unsolvable things. We distracted them so we would progress and they would not. We’re sorry to announce that, but it’s a necessary part of the story.</p>

<p><em>For those that missed round one completely: — ends with 3301 sending out emails.</em> From here, a fellow named <code>n_</code> (not our <code>n_</code>) posted the URL <code>1853143003544.tk</code> in a chat room on n0v4, which was the sum of the largest number in each group <a href='http://pastebin.com/6CUVHefD'>here</a>. Each group is the larger number, prime factored. The TXT record for that URL said “Go to my largest part”. The largest prime factor of 1853143003544 is 33091839349, so we went to 33091839349.tk. This site had no TXT, but contained HTML with a black background and this image:</p>

<p><img alt='this image' src='http://i.imgur.com/NHYLD.jpg' />.</p>

<p>Someone (we still don’t know who) found <a href='http://pastebin.com/qmCYDDPn'>this text</a>. Someone (again, we don’t know who) identified the picture to be the bottom half of<a href='http://www.gailgastfield.com/mhh/mhh.html'>this poem</a>.</p>

<p>I copied the typed version of the text, and formatted it so that it read like the image version. I created <a href='http://ideone.com/6NwKn'>this code</a> to read the book code from the text - then we got to cginiziglyaobyph.onion. We all registered multiple emails there. To our knowledge, 3301 began sending out codes at Friday, January 20th, 6:49 UTC, about 3-4 days later. <em>End round one, alternate.</em></p>

<p>Somewhere between January 15th and January 16th the onion site (sq6…) came back up. Our emails came in at around 3:45 on January 15th. We put in our numbers at sq6wmgv2zcsrix6t.onion/NUM, which showed <a href='http://pastebin.com/4YaQ0TvJ'>this message</a>.</p>

<p>This message was served only once per number. People who shared their key or message got <a href='http://pastebin.com/3ztaEZ3W'>this</a> by email.</p>

<p>We grabbed our 112 digit numbers (<code>n</code>, from the paste) and a server from <a href='http://voxel.com'>voxel</a>, and factored using <code>factmsieve</code>. It took about 7 hours, and only cost $8.</p>

<p>From there, insert <code>p</code>, <code>q</code>, and <code>n</code> into <a href='http://codepad.org/nBIS91M4'>this script</a>. You’ll get a number which you need to put into the page where you got your message from.</p>

<p>As of January 16th, putting any number into the onion gave a 500 error:</p>

<p><img alt='500 error' src='http://i.imgur.com/mdkZs.png' />.</p>

<p>On January 17th, at around 2:49 UTC, this was fixed, and could ake numbers. When given an RSA-decrypted number, it reported: “Correct. We’ll email you.”</p>

<p>A new email was sent, and told us to go back to the onion/NUM. This led to an updated version, having a poem/song and a <a href='http://pastebin.com/VuyPwuL4'>PGP message</a>.</p>

<p>The PGP message was a <a href='http://droplet.tk/i/O8TrB.midi'>MIDI file</a>.</p>

<p>We developed a procedure for un-puzzling the MIDI:</p>

<p>1. Take the base64-encoded portion of your message with the PGP armour headers around it, remove the “- ” from the beginning and top lines, and feed this into <code>pgp --decrypt habitres.midi &gt; song.midi</code>.</p>

<p>2. Download <code>midiscv</code>, compile, and run <code>./midiscv song.midi song.csv</code></p>

<p>3. Use <a href='http://ideone.com/UNPRU'>this script</a> to produce a message. This script matches the notes in track 3 of the MIDI file with the letter “chorus” at the top of the message with the MIDI in it. This produced a mapping as shown by #INSERT PASTE HERE</p>

<p>4. Using the mapping in reverse from track 2, we produce a message similar to:</p>

<pre><code>very good you have proven to be most dedicated to come this far to attain enlightenment create a gpg key for your email address and upload it to the mit key servers then encrypt the the following word list using the cicada three three zero one public key sign it with your key send the ascii armoured ciphertext to the gmail address from which you received your numbers your words are word1 word2 word3 word4 word5 word6</code></pre>

<p>5. The words appear to be unique for each person. Generate a PGP key using <code>gpg --gen-key</code>, and use the same email address you’ve been using for the puzzle. Upload the key to a PGP server (like MIT’s), with <code>gpg --keyserver pgp.mit.edu --send-key [KEY_ID]</code>.</p>

<p>6. Run <code>gpg --armour --default-key [EMAIL] --sign --encrypt</code>, type your password, paste in the words you have, hit enter, then Control-D. It will print an ASCII armoured message.</p>

<p>7. Send that file to c99…@gmail.com, the one you’ve been receiving emails from.</p>

<p>At around Monday, February 6th, 3301 sent the first email. It explained that there would be no more puzzles. It gave directions to log on to a Tor hidden service, with a given username and password.</p>

<p>From there&#8230; we&#8217;ll have to wait for the next one, I guess.</p>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2012/01/replicating-a-webfaction-site-on-tor" title="Replicating a Webfaction Site on Tor">&larr; Replicating a Webfaction Site on Tor</a></li>
      
      
        <li class="next"><a href="/2012/03/palo-altos-meshnet-and-robotics" title="Palo Alto's Meshnet and Robotics">Palo Alto's Meshnet and Robotics &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    
  </div>
<!--  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>16 March 2012</span></div>
    <div class="rdbWrapper" data-show-read="1" data-show-send-to-kindle="1" data-show-print="0" data-show-email="0" data-orientation="0" data-version="1" data-bg-color="#fdfdfa"></div><script type="text/javascript">(function() {var s = document.getElementsByTagName("script")[0],rdb = document.createElement("script"); rdb.type = "text/javascript"; rdb.async = true; rdb.src = document.location.protocol + "//www.readability.com/embed.js"; s.parentNode.insertBefore(rdb, s); })();</script></div>
</div>
-->


      </div>

    </div> <!-- /container -->

    

    <!-- IDL code -->
    <script type="text/javascript">
        window._idl = {};
        _idl.variant = "banner";
        (function() {
            var idl = document.createElement('script');
            idl.type = 'text/javascript';
            idl.async = true;
            idl.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'members.internetdefenseleague.org/include/?url=' + (_idl.url || '') + '&campaign=' + (_idl.campaign || '') + '&variant=' + (_idl.variant || 'banner');
            document.getElementsByTagName('body')[0].appendChild(idl);
        })();
    </script>
    
  </body>
</html>

